<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8">
    
    <link
      rel="stylesheet"
      href="lib/leaflet.css"
    />
    <link
      rel="icon"
      href="images/logo.png"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/perliedman-leaflet-control-geocoder/1.13.0/Control.Geocoder.css"
    />
  
    <link
      rel="stylesheet"
      href="image/logo.png"
    />
    
    <link
      rel="icon"
      href="lib/geosearch.css"
    />

    <title>Геопортал города Тюмени</title>

    <style>
      body {
        margin: 0;
        padding: 0;
      }
      html, body, #map {
        height: 100%;
        width: 100%;
      
      }
      .leaflet-control-scale {
        font-size: 12px;
      }
      .leaflet-control-scale .leaflet-control-scale-line:last-child {
        display: none;
      }

      .leaflet-control-coordinates {
        border-radius: 7px;
        padding: 5px 10px;
        font-size: 13px;
        height: 10px;
        text-align: center;
        line-height: 12px;
        background-color: rgba(255, 255, 255, 1);
        bottom: -5px;
        box-shadow: 0 0 9px #0c0fc0e6;
      }

      .leaflet-control-layers-toggle {
        background-size: contain;
        background-repeat: no-repeat;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .leaflet-control-layers {
      /*width: 20px;*/
      /*height: 20px;*/
      /*border: 2px solid #ccc;*/
        border-radius: 8px;
        line-height: 12px;
        background-color: rgba(255, 255, 255, 1);
      }

      .leaflet-control-geosearch {
  position: relative;
  bottom: -50px;
}
      
    </style>
  </head>
  <body>
    <div id="map"></div>
<script src="lib/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://raw.githubusercontent.com/calvinmetcalf/leaflet-ajax/master/dist/leaflet.ajax.min.js"></script>
<script src="lib/Leaflet.Coordinates-0.1.5.src.js"></script>
<script src="lib/geosearch.umd.js"></script>

<script>
  var map = L.map('map', {
    attributionControl: false,
    zoomControl: false,
    minZoom: 11,
    maxBounds:[ 
      [56.96839, 65.23384], 
      [57.32589, 65.92023] 
    ],
  }).setView([57.1679, 65.4662], 11);

  var osmLayer = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  }).addTo(map);
  
  const provider = new GeoSearch.OpenStreetMapProvider({
    params: {
    bounded: 1,
    countrycodes: 'ru',
    viewbox: [
      65.2338,
      56.9684,
      65.9202,
      57.3259
    ].join(',')
    }
  });
  const search = new GeoSearch.GeoSearchControl({
    provider: provider,
    style: 'bar',
    autoComplete: true,
    autoCompleteDelay: 250,
    searchLabel: 'Введите адрес',
    notFoundMessage: 'Ничего не найдено',
    showMarker: true,
    showPopup: true,
    marker: {
      icon: new L.Icon.Default(),
      draggable: false,
    },
    popupFormat: ({ query, result }) => result.label,
    resultFormat: ({ result }) => result.label,
    keepResult: true,
  });
  
  map.addControl(search);

  
  var baseLayers = {
        "ЕЭКО": L.tileLayer("https://ngw.fppd.cgkipd.ru/tile/56/{z}/{x}/{y}.png", {
        }),
        "2ГИС": L.tileLayer("https://tile3.maps.2gis.com/tiles?x={x}&y={y}&z={z}&v=1.1", {
        }),        
        "OSM": L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        }),
        "Google": L.tileLayer("https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}", {
        }),
        "Mapbox": L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaG9uZXlmaW5nZXIiLCJhIjoiY2xoZmRnMGY4MTVlYTNzbnY2YTYydmFpZiJ9.hLzJmqq2UXv9czh28X0e-w", {
        }),
        "ПКК": L.tileLayer.wms("https://pkk.rosreestr.ru/arcgis/services/PKK6/CadastreWMS/MapServer/WmsServer", {
        }),
  };

      L.control.layers(baseLayers).addTo(map);

      L.control.coordinates({
        position: "bottomright",
        labelTemplateLat: "Широта: {y}",
        labelTemplateLng: "Долгота: {x}",
        useDMS: true,
        useLatLngOrder: true,
      }).addTo(map);

      L.control.zoom({
			  position: 'topright'
      }).addTo(map);

      L.control.scale().addTo(map);

      
      var myLayer = L.geoJSON();

fetch('https://github.com/tmn72/geoportal/blob/main/geojson/fon.geojson')
  .then(function(response) {
    return response.json();
  })
  .then(function(data) {
    myLayer.addData(data);
    myLayer.addTo(map);
  });
</script>
</body>
</html>